-- Fixed Universal Script Hub - Properly Integrates with lynkUI library
-- This loads the fixed UI library and ensures proper database integration

-- Load the fixed UI library
local Lynk = loadstring(game:HttpGet("https://raw.githubusercontent.com/vvisuall/lynkUI/refs/heads/main/source"))()

-- Create window
local Window = Lynk:CreateWindow({
    Name = "Universal Script Hub",
    Title = "LYNK | No.1 Scripthub", 
    Subtitle = "Find any script for any game | Made by @x_vvw on Discord",
    Accent = Color3.fromRGB(88, 101, 242),
    DefaultKeybind = Enum.KeyCode.Insert
})

-- Load script database from GitHub with proper error handling
local function loadScriptDatabase()
    local success, result = pcall(function()
        return loadstring(game:HttpGet("https://raw.githubusercontent.com/vvisuall/lynkUI/refs/heads/main/scripts.lua"))()
    end)
    
    if success and result then
        print("‚úÖ Script database loaded successfully!")
        return result
    else
        print("‚ùå Failed to load script database:", result)
        -- Fallback database with correct property names
        return {
            ["Universal"] = {
                gameName = "Universal Scripts",
                scripts = {
                    {
                        title = "Infinite Yield", 
                        description = "Admin commands for any game", 
                        LoadString = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()', 
                        RequiresKey = false
                    },
                    {
                        title = "Fly Script", 
                        description = "Universal fly script", 
                        LoadString = 'print("Fly script would execute here")', 
                        RequiresKey = false
                    }
                }
            }
        }
    end
end

-- Load the database
local SCRIPT_DATABASE = loadScriptDatabase()

-- Inject our database into the UI library
Window._scriptDatabase = SCRIPT_DATABASE

-- Success messages
print("üéâ LYNK Script Hub loaded successfully!")
print("üì± Press Insert to toggle the UI")
print("üîó Get key from: https://sub4unlock.io/3HTi5")

-- Show current game info
spawn(function()
    wait(1)
    local currentPlaceId = game.PlaceId
    local success, gameInfo = pcall(function()
        return game:GetService("MarketplaceService"):GetProductInfo(currentPlaceId)
    end)
    
    if success then
        print("üéÆ Current Game:", gameInfo.Name)
        if SCRIPT_DATABASE[currentPlaceId] then
            local scriptCount = #SCRIPT_DATABASE[currentPlaceId].scripts
            print("üìù Found", scriptCount, "scripts for this game!")
        else
            print("üìù No specific scripts for this game, showing Universal scripts")
        end
    end
end)
